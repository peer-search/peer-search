# Claude Code 設定

このディレクトリには、Claude Codeのカスタム設定が含まれています。これには、このプロジェクトでClaudeの機能を拡張する専門的なエージェントとスラッシュコマンドが含まれます。

## ディレクトリ構造

```
.claude/
├── agents/          # カスタムエージェント定義
│   └── ui-designer.md
└── commands/        # スラッシュコマンド
    └── ui-designer.md
```

## エージェント vs コマンド

### エージェント (`/agents/`)

**エージェント**は、特定の専門知識とワークフローを持つ専門的なAIアシスタントです。以下の特徴を持つ自律的なエンティティです:
- 独自のツールセットと機能を持つ
- 事前定義されたワークフローとベストプラクティスに従う
- 特定のドメイン（例: UIデザイン、テスト、ドキュメント）に特化
- コマンドや他のエージェントから呼び出される

エージェントは、専門的な役割を持つエキスパートチームメンバーと考えてください。

### コマンド (`/commands/`)

**コマンド**は、会話中に呼び出せるカスタムスラッシュコマンド（`/`で始まる）です。以下のことができます:
- 専門的なエージェントを起動
- 事前定義されたワークフローを実行
- パラメータ付きの構造化されたプロンプトを提供
- 複雑な複数ステップの操作を簡素化

コマンドは、特定の機能へのショートカットまたはエントリーポイントと考えてください。

## 利用可能なコマンド

### `/serena` - セマンティックコード操作

Serena MCPサーバーを使用した効率的でトークン最適化されたコード操作を提供します。シンボルベースの検索・編集により、構造化されたコーディングタスクを実行します。

#### 使い方

```bash
/serena
```

パラメータなしで呼び出すと、Serenaエージェントが起動し、対話的にタスクを実行します。

#### Serenaができること

1. **効率的なコード探索**
   - `get_symbols_overview`: ファイルのシンボル概要を取得（ファイル全体を読まずに構造を理解）
   - `find_symbol`: 名前パスパターンでシンボル（クラス、メソッド、関数など）を検索
   - `find_referencing_symbols`: シンボルへの参照を検索
   - `search_for_pattern`: 柔軟なパターンマッチング検索

2. **シンボルベースの編集**
   - `replace_symbol_body`: シンボル本体を置換
   - `insert_after_symbol`: シンボルの後にコードを挿入
   - `insert_before_symbol`: シンボルの前にコードを挿入
   - `rename_symbol`: コードベース全体でシンボルをリネーム

3. **プロジェクト記憶**
   - `write_memory`: プロジェクト情報をメモリに保存
   - `read_memory`: 保存されたメモリを読み込み
   - `list_memories`: 利用可能なメモリファイルをリスト
   - `edit_memory`: メモリファイルを編集
   - `delete_memory`: 不要なメモリを削除

4. **標準ファイル操作**
   - `list_dir`: ディレクトリ内容をリスト
   - `find_file`: ファイルマスクでファイルを検索

#### 主な特徴

- **トークン効率**: ファイル全体を読まずに必要な部分だけを取得
- **シンボル指向**: クラス、メソッド、関数などの言語構造を理解
- **構造化アプローチ**: 段階的な情報収集と変更
- **プロジェクト記憶**: 将来のタスクのためにコンテキストを保存

#### 使用例

```bash
# 一般的なコーディングタスク
/serena

# エージェント起動後の典型的なワークフロー:
# 1. get_symbols_overview でファイル構造を理解
# 2. find_symbol で特定のシンボルを検索
# 3. replace_symbol_body でシンボルを編集
# 4. find_referencing_symbols で影響範囲を確認
```

#### ベストプラクティス

- **段階的な探索**: まず概要を取得し、その後詳細を調査
- **シンボル優先**: ファイル全体を読む前にシンボルツールを使用
- **メモリ活用**: プロジェクト情報を記憶に保存して効率化
- **最小限の読み取り**: タスクに必要なコードのみを読み取る

#### 名前パスの理解

名前パスはソースファイル内のシンボルツリーのパスです:
- `MyClass` - どこにでもあるMyClassという名前のシンボル
- `MyClass/my_method` - MyClass内のmy_methodメソッド
- `/MyClass/my_method` - ファイル内の正確な完全パス
- `MyClass/my_method[0]` - オーバーロードされたメソッドの最初のバージョン

#### 前提条件

- Serena MCPサーバーが設定されていること
- プロジェクトがSerana対応言語（Python、TypeScript、JavaScript等）で書かれていること

#### 他のツールとの違い

| 機能 | Serena | 標準ツール |
|------|--------|-----------|
| ファイル読み取り | シンボル単位 | ファイル全体 |
| コード検索 | セマンティック | テキストベース |
| 編集 | シンボル構造保持 | 文字列置換 |
| トークン使用 | 最適化 | 標準 |

### `/ui-designer` - UIデザインと洗練

Playwrightを使用してアプリケーションの視覚的デザインとユーザーエクスペリエンスをリアルタイムで分析・改善する専門的なUIデザイナーエージェントを起動します。

#### 使い方

```bash
/ui-designer [page-url] [focus-area]
```

#### パラメータ

- **page-url** (オプション): 対象ページのURLまたはパス
  - 例: `/login`, `http://localhost:3000/dashboard`
  - 省略した場合、ホームページから開始するか、対象を尋ねます

- **focus-area** (オプション): 特に注目する領域
  - 例: `spacing`, `colors`, `responsive`, `accessibility`
  - 省略した場合、一般的なUI評価を実行します

#### 例

```bash
# 一般的なUIレビュー
/ui-designer

# 特定のページ
/ui-designer /login

# 特定の改善に焦点
/ui-designer /dashboard spacing

# 完全なURLとフォーカス
/ui-designer http://localhost:3000/profile responsive
```

#### UIデザイナーができること

1. **セットアップとナビゲーション**
   - 開発サーバーが起動していることを確認
   - Playwrightブラウザで対象ページを開く
   - 初期スナップショット/スクリーンショットを取得

2. **現在の状態を分析**
   - 要素の階層とアクセシビリティツリーをレビュー
   - 視覚的な不整合を特定
   - レスポンシブ動作を確認
   - インタラクティブ要素をテスト

3. **改善を実装**
   - コンポーネントとスタイルに的を絞った変更を加える
   - Tailwind CSSユーティリティとshadcn/uiパターンを使用
   - デザインシステムの一貫性を確保

4. **検証と反復**
   - リロードして変更を確認
   - 変更前後の状態を比較
   - 機能が保持されているかテスト
   - フィードバックに基づいて反復

5. **変更を文書化**
   - 実施した改善点をまとめる
   - 問題や推奨事項を記録

#### よくあるフォーカス領域

- **spacing**: パディング、マージン、要素間のギャップ
- **colors**: 色の一貫性、コントラスト、テーマの適用
- **typography**: フォントサイズ、ウェイト、行の高さ、可読性
- **responsive**: 異なる画面サイズでのレイアウト動作
- **accessibility**: セマンティックHTML、ARIAラベル、キーボードナビゲーション
- **interactive**: ボタンの状態、ホバーエフェクト、トランジション
- **consistency**: ページ間でのコンポーネントスタイルの統一性

#### 前提条件

- 開発サーバーが起動していること (`npm run dev`)
- Playwright MCPサーバーが利用可能であること
- 対象ページにアクセス可能であること

#### 出力

エージェントは以下を提供します:
- 現在の状態分析
- 特定された問題のリスト
- 実装された変更
- 変更前後の比較（スナップショット/スクリーンショット経由）
- さらなる改善のための推奨事項

#### 安全性

- UI関連のコード（コンポーネント、スタイル）のみを変更
- ビジネスロジックと機能は変更されません
- すべての変更はライブテストで検証されます
- 大きな構造的変更の前にエージェントが確認を求めます

## 技術スタック

UIデザイナーエージェントは以下に最適化されています:
- **Tailwind CSS 4**: ユーティリティファーストCSSフレームワーク
- **shadcn/ui**: アクセシブルなコンポーネントライブラリ
- **Playwright**: ライブテストのためのブラウザ自動化
- **Next.js**: Reactフレームワーク（該当する場合）

## カスタムコマンドの作成

独自のスラッシュコマンドを作成するには:

1. `.claude/commands/`に新しい`.md`ファイルを作成
2. メタデータを含むフロントマターを追加:
   ```yaml
   ---
   name: command-name
   description: Brief description
   allowed-tools: Tool1, Tool2
   argument-hint: [arg1] [arg2]
   ---
   ```
3. 本文に指示を記述
4. コマンドが`/command-name`として利用可能になります

## カスタムエージェントの作成

カスタムエージェントを作成するには:

1. `.claude/agents/`に新しい`.md`ファイルを作成
2. 以下を定義:
   - 目的と機能
   - ワークフローとベストプラクティス
   - 主要なツールとその使用方法
   - セッション例
3. エージェントを起動するコマンドを作成（オプションですが推奨）

## サポート

問題や質問がある場合:
- 公式Claude Codeドキュメントを確認
- エージェントとコマンドファイルの詳細な指示をレビュー
- 開発チームに相談

---

**注意**: この設定はこのプロジェクト専用であり、私たちの技術スタックと開発ワークフローに最適化されています。
